/*! auralizr 2014-06-18 */
!function(){function a(){var a=this;return this.userMediaSupport=!1,this.isMicEnabled=!1,this.irArray={},this.startRequest=!1,window.AudioContext=window.AudioContext||window.webkitAudioContext,this.audioContext=new AudioContext,this.convolver=this.audioContext.createConvolver(),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia,navigator.getUserMedia?(this.userMediaSupport=!0,void navigator.getUserMedia({audio:!0},function(b){a.isMicEnabled=!0;var c=a.audioContext.createMediaStreamSource(b);c.connect(a.convolver),a.startRequest&&a.start()},function(){console.log("Error getting audio stream from getUserMedia")})):(console.log("Unfortunately, your browser doesn't support the getUserMedia API needed for this expiriment. Try using Chrome instead"),null)}a.prototype.load=function(a,b,c){var d=this;if("string"==typeof a){var e=new XMLHttpRequest;e.open("GET",a,!0),e.responseType="arraybuffer",e.onload=function(){d.audioContext.decodeAudioData(e.response,function(a){d.irArray[b]=a,c(b)})},e.send()}else a instanceof AudioBuffer&&(d.irArray[b]=a,c(b))},a.prototype.isReady=function(a){return this.isMicEnabled&&this.irArray.hasOwnProperty(a)&&void 0!==this.irArray[a]},a.prototype.use=function(a){this.irArray.hasOwnProperty(a)&&void 0!==this.irArray[a]&&(this.convolver.buffer=this.irArray[a])},a.prototype.start=function(){return this.startRequest=!0,this.isMicEnabled?null===this.convolver.buffer?void console.log("Couldn't start the Auralizr. Buffer is not loaded"):(console.log("Starting Auralizr"),this.convolver.connect(this.audioContext.destination),void(this.startRequest=!1)):void console.log("Couldn't start the Auralizr. Mic is not enabled")},a.prototype.stop=function(){this.startRequest=!1,console.log("Stopping Auralizr"),this.convolver.disconnect()},"undefined"==typeof module?window.Auralizr=a:module.exports=a}();